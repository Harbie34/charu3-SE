■変更点
α→α2
・Win98用にフック処理を入れました。
・ポップアップを閉じるときのアクティブ処理を変えました。
・ワンタイム項目をクリックしただけでロックされたので、アイコンをクリックに変更。
・キーダブルクリックを設定したとき、ポップアップを閉じる処理に問題があったの修正。
・xyzzyでも貼り付けできるようにしました。ctrl+ins、shift+insで使ってる人は追加キー設定にキー設定を追加してください。
α2→α3
・アイコンファイルを選べるようにしました。ビジュアル設定のところです。
・データが全く無いと新規フォルダを作れないバグを修正。
・データファイルがリードオンリーの場合エラーを表示するように修正。
・ポップアップの右クリックメニューの構成を変更。
・履歴データのアイコンが出ないバグを修正。
・データファイル切り替えをするとプラグインが使えなくなるバグを修正。
・ストックモードではルートの項目だけ処理するように変更。
・アプリケーションキーでメニューが出ないバグを修正。
α3→α4
・クイックアクセスでの大文字小文字判定を設定できるようにしました。
・テキスト追加でタイトルが空の場合自動で作るように変更。
・データ互換プラグインでデータの保存が常に失敗を返すバグを修正。
・デスクトップ隅のポップアップ範囲を設定できるようにしました。ユーザー名フォルダのCharu3.iniのEdgePopupPixを直接変更してください。
・色設定のテキストボックすが変更されたら、パレットの色も変えるように変更。
・WM_CHANGECBCHAINの処理を入れ忘れてました。クリップボードの監視をしているようなソフトとの相性が改善すると思います。
・ユーザー名なしだと設定が保存できないバグを修正。
・データファイル切り替えをするとプラグインが使えなくなるバグを修正。
α4→β1
・階層履歴機能を付けました。拡張マクロのClassHistoryで階層履歴内のデータ個数を指定します。CountをClassHistoryで割った数が階層履歴フォルダの数になります。
・ドラッグ&ドロップ中に、アイテムを上端と下端に持っていくとスクロールするようにしました。
・ドラッグ&ドロップ中の操作を制限しました。
・ツリーでTABを押すとチェックボックスが出て複数選択貼り付けが出来るようにしました。チェックをつけた順番で貼り付けられます。ただし、一度この機能を使うとCharu3を再起動するまでチェックボックスは消えません。
・追加キー設定が正常に動いてなかったバグを修正。
・ホットキーコントロールの表示が間違うバグを修正。
・キー設定ダイアログのキー名取得をAPI化。キーレイアウトにも対応しました。
・Windows98でキーダブルクリックが1発でかかってしまうバグを修正。っていうか間違って古いDLLを入れてました。
・コーナーポップアップ1回目にアクティブにならない問題を修正。
・貼り付け時のキー処理を調整。
・キー設定の待ち時間が保存されないバグを修正。
・ベッキーのメールアドレス欄に貼り付け出来ない問題を修正。ウィンドウのアクティブ処理を変えました。
・トレイアイコンからのポップアップで、マウスで決定するとVisualStudioに安定して貼り付けられない問題を修正。
・拡張マクロも検索できるようにしました。内容と一緒に検索します。Hotkeyで検索するとホットキーの管理に最適です。
β1→β2
・クイックアクセスの挙動を少し変えました。
・スペース+Ctrlでチェックを付けるようにしました。TABでもチェックできます。
・設定ダイアログは最上位に表示することにしました。
・チェックしたデータを並べ替えたり消したりしたあと複数貼り付けをすると落ちるバグを修正。
・ビジュアル一括設定機能を付けました。トレイメニューから使えます。
・複数貼り付けの追加に伴い、enterでフォルダを開閉できなくなってたバグを修正。
・起動後１回目の貼り付けが失敗するバグを修正。Windows2000のみ。
β2→RC1
・QTClip互換プラグインを移植。
・Quui互換プラグインを移植。
・HotClipプラグインの履歴処理部分にバグがあって動かなかったので修正。
・フォルダのコピー処理を作り忘れてたので修正。
・ツールチップが出すぎだったり出っ放しだったりで鬱陶しいので制御してみました。
・フォルダの選択位置を保存しない設定だと、フォルダに割り当てたホットキーを押した時ポップアップした後にフォルダが開かなかったので修正。
・ストックモードのキー設定自動切換えにバグがあったので修正。
・ストックモードOFFの時にコピーしたものと同じ物を、ストックモードON直後にコピーしてもストックされるように変更。
・キー設定を削除するとき、1番目から削除をして全部消すとCharu3が落ちるバグを修正。
・ポップアップでF1キーを押すと、選択データの内容を表示するようにしました。
・ポップアップでキー入力をするとマウスカーソルが消えるようにしました。
RC1→RC2
・マウスでチェック操作を出来るように修正。最初は右クリックメニューから。次からはチェックボックスをクリックすればチェックできます。
・フォルダを移動すると落ちるバグを修正。フォルダコピーを付けた時にバグを入れちゃいました。
・タブオーダーとか誤字とか、リソースをちょこちょこ修正しました。
・設定ダイアログのタブを、page upとpage downで切り替えられるようにしました。
RC2→RC3
・履歴フォルダを移動した後コピーすると、2重にコピーされるバグを修正。
RC3→RC4
・クイックアクセスの挙動をエクスプローラのインクリメントサーチと同じ様に変更しました。
・ツリーの再構築機能を付けました。チェックボックスを使った後とか、アイコンファイルを変更した後に動きます。自動で再構築するかどうかは[設定]-[ビジュアル]で変更できます。手動で再構築する場合はトレイメニューから行ってください。
・拡張マクロにダイレクトコピーを追加。DirectCopy=ctrl+f9とか書くと、エディタ等でテキストを選択してctrl+f9を押したとき、そのデータに選択テキストが入ります。Hotkeyマクロと組み合わせて使うと、特定のキーに専用のクリップボードがあるような感覚で使えます。DirectCopy=ctrl+f9、Hotkey=shift+f9みたいな。
RC4→RC5
・インポート後の処理を変更。重複データも取り込めるようにしました。
・多分最後なのでフルセットで提供。
RC5→Ver 03.02.01
・Charu2Proのデータをインポートするときに、データの内容によって一部データが欠損するバグを修正。
・巨大なテキストをコピーすると長時間固まるバグを修正。履歴のタイトルを作る処理でテキスト全体に対して置換処理をしてたのが原因。
・履歴を保存しない(ClearRec=yes)履歴フォルダのデータを複数貼り付けすると履歴が全部消えちゃうバグを修正。ツリー再構築時にデータを読み直してため。
Ver 03.02.14
・UniCode版を用意しました。韓国語とかウムラウト文字とか、多言語が扱えます。WindowsNT,2000,XP専用です。
・ビジュアル設定で選んだフォントを、プロパティとデータ追加画面でも使うようにしました。
・データファイル切り替えで失敗した後のエラー処理を追加。新しい形式のデータがあった場合、上書きしちゃうバグを修正。
・Shiftを押しながら決定すると、クリップボードに入れるだけで貼り付けをしない機能を追加。キーボードマクロは展開しません。
・貼り付けのキー設定にCharu2Proライクを追加。Charu2Proでは貼り付けられたのに・・って場合に使うと解決するかもしれません。
・ポップアップの時にIMEを自動でOFFにする機能を追加。初期設定では無効になってます。
・フックDLLの処理を変えました。98系でキーダブルタップポップアップを使ってる人だけ関係アリ。
・Windows98でポップアップのホットキーをキーダブルクリックに設定しないと、他の(ストックモード切替とか拡張マクロ)ホットキーでキーダブルクリックが使えないバグを修正。
Ver 03.03.01
・Windows98で使ってるキーフックDLLで、ソフトによって相性が悪い不具合を修正。
・Win98系のOSで、ポップアップの右クリックメニューから設定を選ぶと、その次のポップアップの時にCharu3が落ちるバグを修正。
・親のいない子がインポートデータにまぎれると履歴が2重に取られるなどのバグが出る問題を修正。Charu2Proの標準データにゴミデータが入ってるのが原因。 
・デバッグログを記録する機能を追加。Charu3.iniのDebugを1にするとログを取ります。どういう流れで動いてるかをテキストに記録します。なにかおかしな現象があったらデバッグログを送って下さい。
・ペースト後に最小化してメモリを解放しない設定を追加。
・スクロールバーを出さないようにする設定を追加。マウスも使う人は縦のみ、キーボードしか使わない人は両方外しちゃうのがクールですぜ。
Ver 03.03.14
・デフォルトキー設定のキー名にinserキーが設定されるとNumn0と表示されるバグを修正。
・Unicode版の場合マクロテンプレートにキー入力マクロが入らないバグを修正。
・標準データのgoogle検索にゴミが入ってたので取りました。
・デフォルトのビジュアル設定ファイルを用意しました。
・データが履歴フォルダ1つだけ(つまりデータ件数1)の場合クリップボード履歴を取らないバグを修正。
・アイコンファイルのサイズを設定ファイルで決めてました(18x18)が、読み込んだビットマップから取得したサイズにするようにしました。24x24とか12x12とか大きさの違うアイコンを作って使えます。
・終了時にデータファイルを保存するように変更。
・終了時にDLLの解放やホットキーの解放を明示的にするように追加。
・Ver 03.03.03βにバグが入ってて、ウィンドウ切り替え1回目のCtrl+Vでペーストできなくなってたので修正。
・Win2000、XP上でCharu3→Keylay21→Danaの順でプログラムを起動するとCharu3が履歴処理出来なくなる問題を修正。他に問題出るかもしれないので、なにかあったら教えてください。
・複数のキー設定を一つのソフトに登録できるようにしました。Opera7.02やMetaキーを使う設定のTeraTermに対応できます。
・ストックモードの重複チェックを設定で変えられるように変更。
・履歴フォルダの重複チェックを設定する拡張マクロ「DuplicationCheck」を追加。

Ver 03.04.11
・固有キー設定が関係ないウィンドウにも適用される場合があるバグを修正。
・階層の深いところにあるデータをエクスポートすると、それをインポート出来なくなるバグを修正。
・Wordバグに対応するをON、ストックモードの重複チェックをするをOFFにした場合、ストックモードの内容がループするバグを修正。

・ログファイルは実行ファイル(Charu3.exe)がある場所に固定して保存するように変更。
・選択テキストやクリップボードにCharu3のマクロが入っていた場合、そのマクロを無視するように変更。
・プラグインが処理したテキストに入っているマクロを処理しないようにしました。
・「デスクトップ外にポップアップしたら補正する」機能を設定で変更できるようにしました。
・Windowsをシャットダウンする時にデータを保存するようにしました。


Ver 03.05.01
・キー入力マクロの動作をちょっと変えました。ペーストキーを押すときの動作に合わせてました。
・追加キー設定のメッセージ方式で使うメッセージを設定可能にしました。
・ツールチップの表示項目を設定できるようにしました。ビジュアル設定にあります。
・ビジュアル設定読み込みで使える設定に「シンプル」を追加しました。アイコンと配色をシンプルにしてあります。トレイメニューからどうぞ。
・ワンクリックでフォルダの開閉をできるように設定に追加しました。ツリーの属性でいうところの、SINGLE_EXPANDです。
・ホットキーコントロールを改良。今まで入力できなかったShift+Deleteとか、Alt+Spaceとかもペーストキー設定やポップアップキー設定で使えるようになりました。
・データ互換プラグインがToClipにも対応しました。データの読み書き、インポートが出来ます。
・データ互換プラグインがCLCLにも対応しました。

Ver 03.06.01
・インポート時にルートに直接インポートできるように、ファイル選択ダイアログにチェックボックスを付けました。
・「データを別名で保存する」のファイルの種類にゴミが入っていたので修正しました。
・S-JIS版をデバッグモードで動かして%s%s%s%sという文字列をコピーすると落ちるバグを修正しました。%s%s%s%sをfprintfで出力するとfprintfの内部で落ちるみたいです。仕方ないのでfputsでログを書き出すようにしました。
・ビジュアル設定読み込みのファイル選択ダイアログにデータファイル切り替えのダイアログを使ってしまっていたので修正しました。
・Alt*2をポップアップのホットキーにするとAlt*2で閉じられないバグを修正。
・ダイレクトコピーで空白データが保存されるバグを修正。
・ダイレクトコピーで同じデータが複数回保存されるバグを修正


Ver 03.07.07
・クリップボード履歴の容量制限を設定できるようにしました。-1にすると無制限、0にすると履歴拒否になります。サイズはKBで、アプリ毎に設定したい場合は固有キー設定で設定してください。
・クリップボード履歴などで、項目の名前を自動で付けるロジックで今までスペースはカットしてたんですが、英文などの場合読みづらくなるので複数のスペースを一つに纏めるように変えました(最低でも一つはスペースが入る)。ただし全角スペースは完全にカットされます。
・選択テキストマクロを使って、$CLIPを含むテキストを選択して処理すると$CLIPが展開されてしまうので修正しました。
・デフォルトキー設定のメッセージ方式が機能しなくなっていたバグを修正しました。WM_COPYとWM_PASTEを送ります(他のメッセージを使いたい場合は固有キー設定で)。
・各設定画面のタブオーダーがおかしくなってたので修正しました。






・キーボードで並べ替えCtrl+上下キー
・URLエンコード、デコードプラグイン
・ビジュアル設定保存機能






